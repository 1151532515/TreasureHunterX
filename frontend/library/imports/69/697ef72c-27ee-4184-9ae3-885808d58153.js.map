{"version":3,"sources":["../../../../assets/scripts/assets/scripts/TreasurePickedUpAnim.js"],"names":["cc","Class","extends","Component","properties","pickedUpAnimNode","type","Node","default","durationMillis","binglingAnimNode","binglingAnimDurationMillis","setData","treasureInfo","self","score","spriteComponent","getComponent","Sprite","loader","loadRes","SpriteFrame","err","frame","warn","spriteFrame","update","dt","changingNode","elapsedMillis","Date","now","startedAtMillis","active","node","destroy","firstDurationMillis","posDiff","v2","yIncreaseSpeed","setPosition","position","add","scale","scaleIncreaseSpeed","xIncreaseSpeed","yDecreaseSpeed","opacity","opacityDegradeSpeed","onLoad","scondDurationMillis"],"mappings":"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","file":"TreasurePickedUpAnim.js","sourceRoot":"../../../../assets/scripts","sourcesContent":["cc.Class({\n  extends: cc.Component,\n\n  properties: {\n    pickedUpAnimNode: {\n      type: cc.Node,\n      default: null\n    },\n    durationMillis: {\n      default: 0 \n    },\n    binglingAnimNode: {\n      type: cc.Node,\n      default: null\n    },\n    binglingAnimDurationMillis: {\n      default: 0\n    }\n  },\n \n\n  setData (treasureInfo) {\n    const self = this;\n    this.score = treasureInfo.score ? treasureInfo.score : 100 ;\n    this.type = treasureInfo.type ? treasureInfo.type : 1;\n    const spriteComponent = this.pickedUpAnimNode.getComponent(cc.Sprite);\n    //hardcode treasurePNG's path.\n    cc.loader.loadRes(\"textures/treasures/\"+ this.type, cc.SpriteFrame, function (err, frame) {\n      if(err){\n        cc.warn(err);\n        return;\n      }\n      spriteComponent.spriteFrame = frame; \n    })\n  },\n  \n  // LIFE-CYCLE CALLBACKS:\n  update (dt) {\n    const changingNode = this.pickedUpAnimNode; \n    const elapsedMillis = Date.now() - this.startedAtMillis; \n    if(elapsedMillis > this.binglingAnimDurationMillis && this.binglingAnimNode.active) {\n      this.binglingAnimNode.active = false;\n      this.startedAtMillis = Date.now();\n    }\n    if(this.binglingAnimNode.active)\n      return;\n    if (elapsedMillis > this.durationMillis) {\n      this.node.destroy();\n      return;\n    }\n    if (elapsedMillis <= this.firstDurationMillis) {\n      let posDiff = cc.v2(0, dt * this.yIncreaseSpeed);\n      changingNode.setPosition(changingNode.position.add(posDiff));\n      changingNode.scale += (this.scaleIncreaseSpeed*dt); \n    } else {\n      let posDiff = cc.v2(dt * this.xIncreaseSpeed , ( -1 *dt * this.yDecreaseSpeed));     \n      changingNode.setPosition(changingNode.position.add(posDiff));\n      changingNode.opacity -= dt * this.opacityDegradeSpeed;\n    }\n  },\n\n  onLoad() {\n    this.pickedUpAnimNode.scale = 0; \n    this.startedAtMillis = Date.now();\n\n    this.firstDurationMillis = (0.8*this.durationMillis);\n    this.yIncreaseSpeed = (200 *1000/this.firstDurationMillis);\n    this.scaleIncreaseSpeed = (2 * 1000/this.firstDurationMillis);\n\n    this.scondDurationMillis = (0.2 * this.durationMillis );\n    this.opacityDegradeSpeed = (255*1000/this.scondDurationMillis);\n    this.yDecreaseSpeed = (30*1000/this.scondDurationMillis);\n    this.xIncreaseSpeed = (20*1000/this.scondDurationMillis);\n  }\n});\n"]}