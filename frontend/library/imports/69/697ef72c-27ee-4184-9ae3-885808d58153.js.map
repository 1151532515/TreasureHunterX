{"version":3,"sources":["..\\..\\..\\..\\assets\\scripts/assets\\scripts\\TreasurePickedUpAnim.js"],"names":["cc","Class","extends","Component","properties","pickedUpAnimNode","type","Node","default","durationMillis","binglingAnimNode","binglingAnimDurationMillis","scoreLabelNode","setData","treasureInfo","self","score","getComponent","Label","string","spriteComponent","Sprite","loader","loadRes","SpriteFrame","err","frame","warn","spriteFrame","update","dt","changingNode","elapsedMillis","Date","now","startedAtMillis","active","node","destroy","firstDurationMillis","posDiff","v2","yIncreaseSpeed","setPosition","position","add","scale","scaleIncreaseSpeed","xIncreaseSpeed","yDecreaseSpeed","opacity","opacityDegradeSpeed","onLoad","scondDurationMillis"],"mappings":"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","file":"TreasurePickedUpAnim.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["cc.Class({\r\n  extends: cc.Component,\r\n\r\n  properties: {\r\n    pickedUpAnimNode: {\r\n      type: cc.Node,\r\n      default: null\r\n    },\r\n    durationMillis: {\r\n      default: 0 \r\n    },\r\n    binglingAnimNode: {\r\n      type: cc.Node,\r\n      default: null\r\n    },\r\n    binglingAnimDurationMillis: {\r\n      default: 0\r\n    },\r\n    scoreLabelNode: {\r\n      type: cc.Node,\r\n      default: null\r\n    }\r\n  \r\n  },\r\n \r\n\r\n  setData (treasureInfo) {\r\n    const self = this;\r\n    this.score = treasureInfo.score ? treasureInfo.score : 100 ;\r\n    this.type = treasureInfo.type ? treasureInfo.type : 1;\r\n    this.scoreLabelNode.getComponent(cc.Label).string = this.score;\r\n    const spriteComponent = this.pickedUpAnimNode.getComponent(cc.Sprite);\r\n    //hardcode treasurePNG's path.\r\n    cc.loader.loadRes(\"textures/treasures/\"+ this.type, cc.SpriteFrame, function (err, frame) {\r\n      if(err){\r\n        cc.warn(err);\r\n        return;\r\n      }\r\n      spriteComponent.spriteFrame = frame; \r\n    })\r\n  },\r\n  \r\n  // LIFE-CYCLE CALLBACKS:\r\n  update (dt) {\r\n    const changingNode = this.pickedUpAnimNode; \r\n    const elapsedMillis = Date.now() - this.startedAtMillis; \r\n    if(elapsedMillis >= this.binglingAnimDurationMillis && this.binglingAnimNode.active) {\r\n      this.binglingAnimNode.active = false;\r\n      this.startedAtMillis = Date.now();\r\n    }\r\n    if(this.binglingAnimNode.active)\r\n      return;\r\n    if (elapsedMillis > this.durationMillis) {\r\n      this.node.destroy();\r\n      return;\r\n    }\r\n    if (elapsedMillis <= this.firstDurationMillis) {\r\n      let posDiff = cc.v2(0, dt * this.yIncreaseSpeed);\r\n      changingNode.setPosition(changingNode.position.add(posDiff));\r\n      this.scoreLabelNode.setPosition(this.scoreLabelNode.position.add(posDiff));\r\n      changingNode.scale += (this.scaleIncreaseSpeed*dt); \r\n    } else {\r\n      let posDiff = cc.v2(dt * this.xIncreaseSpeed , ( -1 *dt * this.yDecreaseSpeed));     \r\n      changingNode.setPosition(changingNode.position.add(posDiff));\r\n      this.scoreLabelNode.setPosition(this.scoreLabelNode.position.add(posDiff));\r\n      changingNode.opacity -= dt * this.opacityDegradeSpeed;\r\n      this.scoreLabelNode.opacity -= dt * this.opacityDegradeSpeed;\r\n    }\r\n  },\r\n\r\n  onLoad() {\r\n    this.pickedUpAnimNode.scale = 0; \r\n    this.startedAtMillis = Date.now();\r\n\r\n    this.firstDurationMillis = (0.8*this.durationMillis);\r\n    this.yIncreaseSpeed = (200 *1000/this.firstDurationMillis);\r\n    this.scaleIncreaseSpeed = (2 * 1000/this.firstDurationMillis);\r\n\r\n    this.scondDurationMillis = (0.2 * this.durationMillis );\r\n    this.opacityDegradeSpeed = (255*1000/this.scondDurationMillis);\r\n    this.yDecreaseSpeed = (30*1000/this.scondDurationMillis);\r\n    this.xIncreaseSpeed = (20*1000/this.scondDurationMillis);\r\n  }\r\n});\r\n"]}