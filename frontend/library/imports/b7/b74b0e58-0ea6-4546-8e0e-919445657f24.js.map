{"version":3,"sources":["..\\..\\..\\..\\assets\\scripts/assets\\scripts\\SelfPlayer.js"],"names":["BasePlayer","require","cc","Class","extends","start","prototype","call","onLoad","clips","_canMoveBy","vecToMoveBy","superRet","self","computedNewDifferentPosLocalToParentWithinCurrentFrame","node","position","add","currentSelfColliderCircle","getComponent","CircleCollider","nextSelfColliderCircle","contactedBarriers","length","contactedNPCPlayers","contactedControlledPlayers","mutatedVecToMoveBy","mul","offset","radius","aCircleCollider","contactedCircleLocalToParentWithinCurrentFrame","Intersection","circleCircle","update","dt"],"mappings":";;;;;;AAAA,IAAMA,aAAaC,QAAQ,cAAR,CAAnB;;AAEAC,GAAGC,KAAH,CAAS;AACPC,WAASJ,UADF;;AAGP;AACAK,OAJO,mBAIC;AACNL,eAAWM,SAAX,CAAqBD,KAArB,CAA2BE,IAA3B,CAAgC,IAAhC;AACD,GANM;AAQPC,QARO,oBAQE;AACPR,eAAWM,SAAX,CAAqBE,MAArB,CAA4BD,IAA5B,CAAiC,IAAjC;AACA,SAAKE,KAAL,GAAa;AACX,YAAM,sBADK;AAEX,aAAO,yBAFI;AAGX,aAAO,uBAHI;AAIX,YAAM,wBAJK;AAKX,aAAO,0BALI;AAMX,YAAM,2BANK;AAOX,cAAQ,6BAPG;AAQX,aAAO;AARI,KAAb;AAUD,GApBM;AAsBPC,YAtBO,sBAsBIC,WAtBJ,EAsBiB;AACtB,QAAMC,WAAWZ,WAAWM,SAAX,CAAqBI,UAArB,CAAgCH,IAAhC,CAAqC,IAArC,EAA2CI,WAA3C,CAAjB;AACA,QAAME,OAAO,IAAb;;AAEA,QAAMC,yDAAyDD,KAAKE,IAAL,CAAUC,QAAV,CAAmBC,GAAnB,CAAuBN,WAAvB,CAA/D;;AAEA,QAAMO,4BAA4BL,KAAKE,IAAL,CAAUI,YAAV,CAAuBjB,GAAGkB,cAA1B,CAAlC;AACA,QAAIC,yBAAyB,IAA7B;AACA,QAAI,IAAIR,KAAKS,iBAAL,CAAuBC,MAA3B,IAAqC,IAAIV,KAAKW,mBAAL,CAAyBD,MAAlE,IAA4E,IAAIV,KAAKY,0BAAzF,EAAqH;AACnH;AACA,UAAMC,qBAAqBf,YAAYgB,GAAZ,CAAgB,CAAhB,CAA3B;AACAN,+BAAyB;AACvBL,kBAAUH,KAAKE,IAAL,CAAUC,QAAV,CAAmBC,GAAnB,CAAuBN,YAAYgB,GAAZ,CAAgB,CAAhB,CAAvB,EAA2CV,GAA3C,CAA+CC,0BAA0BU,MAAzE,CADa;AAEvBC,gBAAQX,0BAA0BW;AAFX,OAAzB;AAID,KAPD,MAOO;AACLR,+BAAyB;AACvBL,kBAAUF,uDAAuDG,GAAvD,CAA2DC,0BAA0BU,MAArF,CADa;AAEvBC,gBAAQX,0BAA0BW;AAFX,OAAzB;AAID;;AApBqB;AAAA;AAAA;;AAAA;AAsBtB,2BAA4BhB,KAAKW,mBAAjC,8HAAsD;AAAA,YAA7CM,eAA6C;;AACpD,YAAIC,iDAAiD;AACnDf,oBAAUc,gBAAgBf,IAAhB,CAAqBC,QAArB,CAA8BC,GAA9B,CAAkCa,gBAAgBF,MAAlD,CADyC;AAEnDC,kBAAQC,gBAAgBD;AAF2B,SAArD;AAIA,YAAI3B,GAAG8B,YAAH,CAAgBC,YAAhB,CAA6BF,8CAA7B,EAA6EV,sBAA7E,CAAJ,EAA0G;AACxG,iBAAO,KAAP;AACD;AACF;AA9BqB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAgCtB,WAAOT,QAAP;AACD,GAvDM;AAyDPsB,QAzDO,kBAyDAC,EAzDA,EAyDI;AACTnC,eAAWM,SAAX,CAAqB4B,MAArB,CAA4B3B,IAA5B,CAAiC,IAAjC,EAAuC4B,EAAvC;AACD;AA3DM,CAAT","file":"SelfPlayer.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["const BasePlayer = require(\"./BasePlayer\"); \r\n\r\ncc.Class({\r\n  extends: BasePlayer,\r\n\r\n  // LIFE-CYCLE CALLBACKS:\r\n  start() {\r\n    BasePlayer.prototype.start.call(this);\r\n  },\r\n\r\n  onLoad() {\r\n    BasePlayer.prototype.onLoad.call(this);\r\n    this.clips = {\r\n      '01': 'FlatHeadSisterRunTop',\r\n      '0-1': 'FlatHeadSisterRunBottom',\r\n      '-20': 'FlatHeadSisterRunLeft',\r\n      '20': 'FlatHeadSisterRunRight',\r\n      '-21': 'FlatHeadSisterRunTopLeft',\r\n      '21': 'FlatHeadSisterRunTopRight',\r\n      '-2-1': 'FlatHeadSisterRunBottomLeft',\r\n      '2-1': 'FlatHeadSisterRunBottomRight'\r\n    };\r\n  },\r\n\r\n  _canMoveBy(vecToMoveBy) {\r\n    const superRet = BasePlayer.prototype._canMoveBy.call(this, vecToMoveBy);\r\n    const self = this;\r\n\r\n    const computedNewDifferentPosLocalToParentWithinCurrentFrame = self.node.position.add(vecToMoveBy);\r\n\r\n    const currentSelfColliderCircle = self.node.getComponent(cc.CircleCollider); \r\n    let nextSelfColliderCircle = null;\r\n    if (0 < self.contactedBarriers.length || 0 < self.contactedNPCPlayers.length || 0 < self.contactedControlledPlayers) {\r\n      /* To avoid unexpected buckling. */\r\n      const mutatedVecToMoveBy = vecToMoveBy.mul(2);\r\n      nextSelfColliderCircle = {\r\n        position: self.node.position.add(vecToMoveBy.mul(2)).add(currentSelfColliderCircle.offset),  \r\n        radius: currentSelfColliderCircle.radius,\r\n      };\r\n    } else {\r\n      nextSelfColliderCircle = {\r\n        position: computedNewDifferentPosLocalToParentWithinCurrentFrame.add(currentSelfColliderCircle.offset),  \r\n        radius: currentSelfColliderCircle.radius,\r\n      };\r\n    }\r\n\r\n    for (let aCircleCollider of self.contactedNPCPlayers) {\r\n      let contactedCircleLocalToParentWithinCurrentFrame = {\r\n        position: aCircleCollider.node.position.add(aCircleCollider.offset),  \r\n        radius: aCircleCollider.radius,\r\n      };\r\n      if (cc.Intersection.circleCircle(contactedCircleLocalToParentWithinCurrentFrame, nextSelfColliderCircle)) {\r\n        return false;\r\n      }\r\n    }\r\n\r\n    return superRet;\r\n  },\r\n\r\n  update(dt) {\r\n    BasePlayer.prototype.update.call(this, dt);\r\n  },\r\n\r\n});\r\n"]}